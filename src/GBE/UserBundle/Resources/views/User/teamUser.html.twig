{# src/GBE/UserBundle/Resources/User/teamUser.html.twig #}

{% extends "GBEUserBundle::user_general.html.twig" %}

{% block title %}
  {{ parent() }} - {{ 'team.titles.team' | trans }}
{% endblock %}

{% block GBE_User_body %}

	<!-- BEGIN leftbar -->
      {% include 'includes/leftbar.html.twig' %}
    <!-- END leftbar -->

	<!-- BEGIN CONTENT -->
	<div class="col-md-8 page-content">  <!-- Must have a col-md-8 -->
		<!-- BEGIN CONTENT -->
		<div class="content">

			{% if teamCurrent %}
				<div>
					<button class="btn btn-perso float-right">
				    	{{ 'team.actions.edit'|trans }}
				     	<i class="fa fa-sign-in"></i>
				    </button>
				</div>
			{% endif %}

			<h2>
				{{ 'team.titles.team'|trans }}
			</h2>
			<hr/>


			{% if teamCurrent %}
				<div class="center">
					<h3 class="italic">
						{% if teamCurrent.name|length > 0 %}
							{{ teamCurrent.name }}
						{% else %}
							{{ 'team.default.noName'|trans }}
						{% endif %}
					</h3>
				</div>
				<div class="row">
					{% for member in members %}
						<div class="col-md-3 center">
							<img src="{{ asset('img/profile/profil_defaut.png') }}" alt="Default" class="avatar_team
									{# if teamCurrent.leader %}
										{% if teamCurrent.leader == member %}
											teamleader_avatar
										{% endif %}
									{% endif #}
									"/> 
							<br/><br/>
							<span class="bold">
								{{ member.firstName }} <br/>
								{{ member.lastName }}
							</span> <br/>
								{{ member.age }}
						</div>
					{% endfor %}
				</div>

				<hr/>

				{% if app.user.route %}
					<div class="single_route">
						<h3>
							{{ 'route.content.step'|trans }} {{ app.user.route.id }} : {{ app.user.route.name }}
						</h3>

						<div class="row">
							<div class="col-md-6">
								<img src="{{ asset(app.user.route.url) }}" alt="{{ app.user.route.alt }}" class="route_img"/>
							</div>
							<div class="col-md-6">
								<div class="row">
									<div class="col-md-5 right bold">
										{{ 'route.content.startCity'|trans }}
									</div>
									<div class="col-md-7 left">
										{{ app.user.route.startCity }}
									</div>
								</div>
								<div class="row">
									<div class="col-md-5 right bold">
										{{ 'route.content.endCity'|trans }}
									</div>
									<div class="col-md-7 left">
										{{ app.user.route.endCity }}
									</div>
								</div>

								<hr/>

								<div class="row">
									<div class="col-md-5 right bold">
										{{ 'route.content.length'|trans }}
										<br/>
										{{ 'route.content.heightPos'|trans }}
										<br/>
										{{ 'route.content.heightNeg'|trans }}
									</div>
									<div class="col-md-3 left">
										{{ app.user.route.length }}
										<br/>
										{{ app.user.route.heightPos }}
										<br/>
										{{ app.user.route.heightNeg }}
									</div>
									<div class="col-md-4 right">
										{% set number_participants = members|length %}

										{% if number_participants < 4 %}
											<button class="btn float-right">
												{% set missing_participants = 4 - number_participants %}
												{{ 'route.titles.missing'|trans }} {{ missing_participants }}
											</button>
										{% else %}
											<button class="btn float-right">
												{{ 'route.titles.full'|trans }}
											</button>
										{% endif %}
										<br/>
										<br/>
										<div class="float-right bold">
											{{ number_participants }} {{ 'route.titles.people'|trans }}
										</div>
									</div>
								</div>
								
								<hr/>

								<div class="row">
									<div class="col-md-5 right bold">
										{{ 'route.content.startDate'|trans }}
									</div>
									<div class="col-md-7 left">
										{{ app.user.route.startDate|date('d M Y') }} - {{ app.user.route.startDate|date('h:i') }}
									</div>
								</div>
								<div class="row">
									<div class="col-md-5 right bold">
										{{ 'route.content.endDate'|trans }}
									</div>
									<div class="col-md-7 left">
										{{ app.user.route.endDate|date('d M Y') }} - {{ app.user.route.endDate|date('h:i') }}
									</div>
								</div>
								
							</div>
						</div>
					</div>

				{% else %}

					<h2>
						{{ 'route.titles.chosenStep'|trans }} : 
					</h2>
					<hr/>

					<div class="center">
						<p>
							<br/><br/><br/><br/>
						</p>
						<p class="center">
							{{ 'route.content.noRouteYetMessage'|trans }}
						</p>
						<p>
							<br/><br/><br/><br/>
						</p>
						<a href="
	    					{% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}
								{{ path('gbe_presentation_route') }}
							{% else %}
								{{ path('fos_user_registration_register') }}
							{% endif %}
							" class="btn btn-perso font18">
					    	{{ 'route.actions.join'|trans }}
					     	<i class="fa fa-sign-in"></i>
					    </a>
					</div>


				{% endif %}

			{% else %}	
				<div class="center">
					<p>
						<br/><br/><br/><br/>
					</p>
					<p class="center">
						{{ 'team.default.noTeamYetMessage'|trans }}
					</p>
					<p>
						<br/><br/><br/><br/>
					</p>
					<a href="
    					{% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}
							{{ path('gbe_presentation_route') }}
						{% else %}
							{{ path('fos_user_registration_register') }}
						{% endif %}
						" class="btn btn-perso font18">
				    	{{ 'team.actions.joinATeam'|trans }}
				     	<i class="fa fa-sign-in"></i>
				    </a>
				</div>

			{% endif %}


		</div>
		<!-- END CONTENT -->
	</div>
	<!-- END CONTENT -->

	<!-- BEGIN rightbar -->
      {% include 'includes/rightbar.html.twig' %}
    <!-- END rightbar -->

{% endblock GBE_User_body %}